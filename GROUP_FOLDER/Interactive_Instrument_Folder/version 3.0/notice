This is the functional version of all programs
